@*@model library.elegalhubs.com.Ticketing.Tickets*@
@model lms.elegalhubs.com.Areas.Admin.Models.TicketIndexViewModel

@{
    ViewData["Title"] = "Details";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}


@section Style{

    @*<link href="~/demo1/assets/plugins/custom/summernote/summernote-bs4.css" rel="stylesheet" />*@
    <link href="@Url.Content("~/demo1/assets/plugins/custom/summernote/summernote-lite.css")" rel="stylesheet" />

    <style>
        .icon-container {
            width: 60px;
            height: 60px;
            line-height: 70px;
            border-radius: 5px;
            text-align: center;
            opacity: 0.5
        }

            .icon-container i {
                font-size: 25px
            }
    </style>

}
<div id="kt_content_container" class="container-xxl">
    <div class="row g-3">
        <div class="col-xxl-8 col-xl-8 col-lg-12 col-md-12">
            <div class="row g-3 mb-3">
                <div class="col-md-4">
                    <div class="card ">
                        <div class="card-body">
                            <div class="d-flex align-items-center">
                                <div class="bg-primary icon-container">
                                    <i class="fas text-inverse-primary fa-info fa-1x"></i>
                                </div>
                                <div class="flex-fill ms-4 text-truncate">
                                    <div class="text-truncate">Status</div>
                                    <span class="badge bg-@((Model.Tickets.StatusTypes) is null ? "info" :Model.Tickets.StatusTypes.Color)">
                                        @Model.Tickets.StatusTypes.Status
                                        @*In Progress*@
                                    </span>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card ">
                        <div class="card-body">
                            <div class="d-flex align-items-center">
                                <div class="icon-container bg-info">
                                    <i class="fas text-inverse-info  fa-user"></i>
                                </div>
                                <div class="flex-fill ms-4 text-truncate">
                                    <div class="text-truncate">Created Name</div>
                                    <span class="fw-bold">
                                        @*Sally Graham*@
                                        @Model.Tickets.User.Name
                                    </span>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card ">
                        <div class="card-body">
                            <div class="d-flex align-items-center">
                                <div class="icon-container bg-danger">
                                    <i class="fas text-inverse-danger fa-tasks"></i>
                                </div>
                                <div class="flex-fill ms-4 text-truncate">
                                    <div class="text-truncate">Priority</div>
                                    <span class="badge bg-@(string.IsNullOrEmpty(Model.Tickets.PriorityTypes.Color)? "info" :Model.Tickets.PriorityTypes.Color)">
                                        @* High*@
                                        @Model.Tickets.PriorityTypes.Priority
                                    </span>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div> <!-- Row end  -->
            <div class="row">
                <div class="col-md-12">
                    <div class="card mb-3">
                        <div class="card-body">
                            <h6 class="fw-bold mb-3 text-danger">@Model.Tickets.Subject</h6>
                            <p>
                                @Model.TicketDetails.Description
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="card" style="min-height:100%">
                        <div class="card-body" style="line-height:2.7">
                            <h6 class="fw-bold mb-3 text-danger"> Ticket Details</h6>
                            <div>
                                <div class="mb-4">
                                    <span class="text-muted">Project: </span>
                                    <span class="mb-0">@Model.Tickets.Projects.Name</span>
                                </div>
                                <div class="mb-4">
                                    <span class="text-muted">Ticket Type: </span>
                                    <span class="mb-0">@Model.Tickets.TicketTypes.TicketType</span>
                                </div>
                                <div class="mb-4">
                                    <span class="text-muted">Category Type : </span>
                                    <span class="mb-0">@Model.Tickets.CategoryTypes.Category</span>
                                </div>
                                <div class="mb-4">
                                    <span class="text-muted">Department : </span>
                                    <span class="mb-0">@(Model.Tickets.Department == null ? "" : Model.Tickets.Department.Name)</span>
                                </div>

                                <div class="mb-4">
                                    <span class="text-muted">Created Date : </span>
                                    <span class="mb-0">@Model.Tickets.OpenDateTime</span>
                                </div>
                                <div class="mb-4">
                                    <span class="text-muted">Start Work Date : </span>
                                    <span class="mb-0">@Model.TicketDetails.StartDateTime</span>
                                </div>
                                <div class="mb-4">
                                    <span class="text-muted">Colse Date : </span>
                                    <span class="mb-0">@Model.TicketDetails.EndDateTime</span>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card" style="min-height:100%">
                        <div class="card-body" style="line-height:2.7">
                            <h6 class="fw-bold mb-3 text-danger"> User Details</h6>
                            <div>
                                @{
                                    if (!(Model.Tickets.User is null))
                                    {
                                        <div class="mb-4">
                                            <span class="text-muted"> Name: </span>
                                            <span class="mb-0">@(string.IsNullOrEmpty(Model.Tickets.User.Name)? "" : Model.Tickets.User.Name)</span>
                                        </div>
                                        @*<div class="mb-4">
                                                <span class="text-muted">Last Name: </span>
                                                <span class="mb-0">@(string.IsNullOrEmpty(Model.Tickets.ContactTypes.LastName)? "" : Model.Tickets.ContactTypes.LastName)</span>
                                            </div>*@
                                        <div class="mb-4">
                                            <span class="text-muted">Email : </span>
                                            <span class="mb-0">@(string.IsNullOrEmpty(Model.Tickets.User.EmailAddress)? "" : Model.Tickets.User.EmailAddress)</span>
                                        </div>
                                        <div class="mb-4">
                                            <span class="text-muted">Contact Number : </span>
                                            <span class="mb-0">@(string.IsNullOrEmpty(Model.Tickets.User.MobileNumber)? "" : Model.Tickets.User.MobileNumber)</span>
                                        </div>

                                        <div class="mb-4">
                                            <span class="text-muted">Preferred Contact MethodId : </span>
                                            <span class="mb-0">@(string.IsNullOrEmpty(Model.Tickets.ContactMethods.ContactMethod)? "" : Model.Tickets.ContactMethods.ContactMethod)</span>
                                        </div>
                                    }
                                }

                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-12">

                    <div class="row g-3">

                        <div class="col-lg-12 col-md-6">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="fw-bold mb-3 text-danger"> File Atteched</h6>
                                    <div class="flex-grow-1">
                                        @{
                                            foreach (var m in Model.TicketAttachements)
                                            {
                                                <div class="py-2 d-flex align-items-center border-bottom">
                                                    <div class="d-flex ms-3 align-items-center flex-fill">
                                                        <span class="avatar lg bg-lightgreen rounded-circle text-center d-flex align-items-center justify-content-center"><i class="icofont-file-pdf fs-5"></i></span>
                                                        <div class="d-flex flex-column ps-3">
                                                            <h6 class="fw-bold mb-0 small-14">@m.FileName</h6>
                                                        </div>
                                                    </div>
                                                    @*<button type="button" class="btn bg-lightgreen text-end">Download</button>*@
                                                    <a class="menu-link px-3" asp-action="DocumentDownload" asp-route-documentId="@m.Id">Download</a>

                                                </div>
                                            }
                                        }


                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xxl-4 col-xl-4 col-lg-12 col-md-12">
            <div class="card">
                <div class="card-body card-body-height py-4">

                    <div class="post">
                        <form asp-action="create" asp-controller="TicketComments" method="post">
                            @Html.AntiForgeryToken()
                            <input type="hidden" value="@Model.Tickets.Id" name="TicketId" />
                            <textarea name="Description" class="form-control" id="summernote" placeholder="Post" rows="4"></textarea>
                            <div class="py-3">
                                <a href="#" class="px-3 " title="upload images"><i class="icofont-ui-camera"></i></a>
                                <a href="#" class="px-3 " title="upload video"><i class="icofont-video-cam"></i></a>
                                <a href="#" class="px-3 " title="Send for signuture"><i class="icofont-pen-alt-2"></i></a>
                                <button class="btn btn-primary float-sm-end  mt-2 mt-sm-0">Sent</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="card mt-5 mb-8">

                <div class="card-body">
                    <h6 class="fw-bold mb-6 text-danger"> Ticket Comments</h6>

                    <!--begin::Timeline-->
                    <div class="timeline">
                        @{
                            foreach (var m in Model.TicketComments)
                            {
                                <!--begin::Timeline item-->
                                <div class="timeline-item">
                                    <!--begin::Timeline line-->
                                    <div class="timeline-line w-40px"></div>
                                    <!--end::Timeline line-->
                                    <!--begin::Timeline icon-->
                                    <div class="timeline-icon symbol symbol-circle symbol-40px me-4">
                                        <div class="symbol-label bg-light">
                                            <!--begin::Svg Icon | path: icons/duotune/communication/com003.svg-->
                                            <span class="svg-icon svg-icon-2 svg-icon-gray-500">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                                    <path opacity="0.3" d="M2 4V16C2 16.6 2.4 17 3 17H13L16.6 20.6C17.1 21.1 18 20.8 18 20V17H21C21.6 17 22 16.6 22 16V4C22 3.4 21.6 3 21 3H3C2.4 3 2 3.4 2 4Z" fill="black" />
                                                    <path d="M18 9H6C5.4 9 5 8.6 5 8C5 7.4 5.4 7 6 7H18C18.6 7 19 7.4 19 8C19 8.6 18.6 9 18 9ZM16 12C16 11.4 15.6 11 15 11H6C5.4 11 5 11.4 5 12C5 12.6 5.4 13 6 13H15C15.6 13 16 12.6 16 12Z" fill="black" />
                                                </svg>
                                            </span>
                                            <!--end::Svg Icon-->
                                        </div>
                                    </div>
                                    <!--end::Timeline icon-->
                                    <!--begin::Timeline content-->
                                    <div class="timeline-content mt-n1">
                                        <!--begin::Timeline heading-->
                                        <div class="pe-3">
                                            <!--begin::Title-->
                                            <div class="d-flex align-items-center mt-1 fs-6">
                                                <!--begin::Info-->
                                                <div class="text-muted me-2 fs-7">Added at @m.CommentDate by <span class="text-dark">@m.user.Name</span></div>
                                                <!--end::Info-->
                                                <!--begin::User-->
                                                <div class="symbol symbol-circle symbol-25px" data-bs-toggle="tooltip" data-bs-boundary="window" data-bs-placement="top" title="Nina Nilson">
                                                    @*<img src="~/demo1/assets/media/avatars/150-11.jpg" alt="img" />*@
                                                </div>
                                                <!--end::User-->
                                            </div>
                                            <!--end::Title-->
                                            <!--begin::Description-->
                                            <div class="fs-5 fw-bold mb-2">
                                                @Html.Raw(m.Description)
                                            </div>
                                            <!--end::Description-->
                                        </div>
                                        <!--end::Timeline heading-->
                                    </div>
                                    <!--end::Timeline content-->
                                </div>
                                <!--end::Timeline item-->
                            }
                        }

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Script{
    @*<script src="~/demo1/assets/plugins/custom/summernote/summernote-bs4.js"></script>*@
    <script src="@Url.Content("~/demo1/assets/plugins/custom/summernote/summernote-lite.js")"></script>
    <script>
        $(document).ready(function () {
            $('#summernote').summernote({
                placeholder: 'Write comment',
                tabsize: 2,
                height: 100
            });
        });
    </script>
}
